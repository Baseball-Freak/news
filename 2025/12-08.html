<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Daily Page</title>
  <style>
    body {
      font-family: sans-serif;
      font-size: 0.8em;
      line-height: 1.4;
      padding: 2em;
      position: relative;
    }
    .nav-buttons {
      position: absolute;
      top: 1em;
      left: 1em;
      display: flex;
      flex-direction: row;
      gap: 0.5em;
    }
    .nav-buttons button {
      width: 80px;
      height: 30px;
      font-size: 0.7em;
      padding: 0;
      border: 1px solid #333;
      border-radius: 4px;
      background-color: #f0f0f0;
      color: #333;
      cursor: pointer;
      text-align: center;
      transition: background-color 0.2s, color 0.2s;
    }
    .nav-buttons button:hover {
      background-color: #ddd;
    }
    .box1 {
      margin-left: -1em;
      margin-top: 3em;
    }
    h3.bar3 {
      font-size: 1.1em;
      margin-left: 1em;
    }
    ul {
      padding-left: 1em;
    }
    li.news-icon {
      margin-bottom: 0.5em;
    }
  </style>
  <script>
    // ゼロ埋め用関数 (例: 1 -> "01")
    const pad = (n) => String(n).padStart(2, '0');

    // 現在のURLから日付オブジェクトを取得する関数
    const getCurrentDateFromURL = () => {
      // URLのパス（例: .../2025/12-08.html）を取得
      const path = location.pathname;
      
      // 正規表現の修正:
      // (\d{4}) -> 年フォルダ
      // \/ -> フォルダ区切りのスラッシュ
      // (\d{2})-(\d{2}) -> 月-日
      // \.html$ -> 拡張子
      const match = path.match(/\/(\d{4})\/(\d{2})-(\d{2})\.html$/);
      
      if (!match) return null;
      
      const [_, yyyy, mm, dd] = match;
      // Dateオブジェクトを作成 (月は0始まりなので-1する)
      return new Date(Number(yyyy), Number(mm) - 1, Number(dd));
    };

    // 前日・翌日へ移動する関数
    const goToRelativeDay = async (offset) => {
      const baseDate = getCurrentDateFromURL();
      
      // URL形式が合わない場合は処理を中断
      if (!baseDate) {
        console.error("URLから日付が取得できませんでした。形式が /yyyy/mm-dd.html であるか確認してください。");
        return;
      }

      // 日付を加算・減算
      baseDate.setDate(baseDate.getDate() + offset);

      // 移動先のパスを作成
      const nextY = baseDate.getFullYear();
      const nextM = pad(baseDate.getMonth() + 1);
      const nextD = pad(baseDate.getDate());

      // ディレクトリ階層を考慮してパスを作成
      // "../2025/12-07.html" のように一度階層を上がってから年フォルダを指定することで
      // 年またぎ（2025年→2026年）の場合も正しく動作します。
      const target = `../${nextY}/${nextM}-${nextD}.html`;

      try {
        // ファイルが存在するか確認 (HEADリクエスト)
        const res = await fetch(target, { method: 'HEAD' });
        
        if (res.ok) {
          location.href = target;
        } else {
          // ファイルがない場合（404など）
          location.href = "pending.html";
        }
      } catch (e) {
        // 通信エラーなどの場合もpendingへ
        location.href = "pending.html";
      }
    };
  </script>
</head>
<body>
  <div class="nav-buttons">
    <button onclick="goToRelativeDay(-1)">Previous</button>
    <button onclick="goToRelativeDay(1)">Next</button>
  </div>
<div class="box1">

<!-- 
  注意: 表示用日付部分は自動更新されません。
  ここをJavaScriptで自動書き換えしたい場合は別途IDを振って処理する必要があります。
-->
<h3 class='bar3'><i class="fas fa-calendar-check"></i>yyyy/mm/dd</h3>
</div>
</body>
</html>
