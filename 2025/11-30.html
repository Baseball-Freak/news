<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Daily Page</title>
  <style>
    body {
      font-family: sans-serif;
      font-size: 0.8em;
      line-height: 1.4;
      padding: 2em;
      position: relative;
    }
    .nav-buttons {
      position: absolute;
      top: 1em;
      left: 1em;
      display: flex;
      flex-direction: row;
      gap: 0.5em;
    }
    .nav-buttons button {
      width: 80px;
      height: 30px;
      font-size: 0.7em;
      padding: 0;
      border: 1px solid #333;
      border-radius: 4px;
      background-color: #f0f0f0;
      color: #333;
      cursor: pointer;
      text-align: center;
      transition: background-color 0.2s, color 0.2s;
    }
    .nav-buttons button:hover {
      background-color: #ddd;
    }
    .box1 {
      margin-left: -1em;
      margin-top: 3em;
    }
    h3.bar3 {
      font-size: 1.1em;
      margin-left: 1em;
    }
  </style>
  <script>
    const pad = (n) => String(n).padStart(2, '0');

    // URLから日付を取得 (/yyyy/mm-dd.html 形式)
    const getCurrentDateFromURL = () => {
      const path = location.pathname;
      // 正規表現: /数字4桁/数字2桁-数字2桁.html
      const match = path.match(/\/(\d{4})\/(\d{2})-(\d{2})\.html$/);
      if (!match) return null;
      const [_, yyyy, mm, dd] = match;
      return new Date(Number(yyyy), Number(mm) - 1, Number(dd));
    };

    // 移動処理
    const goToRelativeDay = async (offset) => {
      const baseDate = getCurrentDateFromURL();
      
      // URL形式が正しくない場合も pending へ
      if (!baseDate) {
        location.href = "../pending.html"; 
        return;
      }

      // 日付計算
      baseDate.setDate(baseDate.getDate() + offset);

      const nextY = baseDate.getFullYear();
      const nextM = pad(baseDate.getMonth() + 1);
      const nextD = pad(baseDate.getDate());

      // 次のファイルのパス (../年/月-日.html)
      const target = `../${nextY}/${nextM}-${nextD}.html`;
      
      // エラー時の移動先 (../pending.html)
      const pendingUrl = "../pending.html"; 

      try {
        // HEADメソッドでファイルの存在確認を行う
        const res = await fetch(target, { method: 'HEAD' });

        if (res.ok) {
          // ファイル(およびフォルダ)が存在すれば移動
          location.href = target;
        } else {
          // 404 Not Found (フォルダがない、ファイルがない) などの場合は pending へ
          location.href = pendingUrl;
        }
      } catch (error) {
        // 通信エラーなどの場合も pending へ
        console.error("Fetch error:", error);
        location.href = pendingUrl;
      }
    };

    // ▼▼▼ 追加機能: ファイル名と記事日付の不一致チェック ▼▼▼
    window.addEventListener('DOMContentLoaded', () => {
      // 1. ファイル名から mm-dd を取得 (例: .../11-01.html)
      // pathの末尾が 数字2桁-数字2桁.html かどうかを判定
      const pathMatch = location.pathname.match(/(\d{2})-(\d{2})\.html$/);
      
      // もしこのファイル名規則に合致しない場合（index.html等）はチェックを行わない
      if (!pathMatch) return;

      const fileMM = pathMatch[1]; // 例: 11
      const fileDD = pathMatch[2]; // 例: 01

      // 2. HTML内の <h3 class='bar3'> から日付テキストを取得
      const h3Element = document.querySelector('h3.bar3');
      
      let isDateMatched = false;

      if (h3Element) {
        // テキスト内容（例: "2025/11/01" やアイコンコード含むテキスト）
        const textContent = h3Element.textContent;
        
        // テキスト内に含まれる /mm/dd 部分を抽出
        // 正規表現: /数字2桁/数字2桁
        const contentMatch = textContent.match(/\/(\d{2})\/(\d{2})/);

        if (contentMatch) {
          const contentMM = contentMatch[1];
          const contentDD = contentMatch[2];

          // ファイル名の mm, dd と、記事内の mm, dd が一致するか比較
          if (contentMM === fileMM && contentDD === fileDD) {
            isDateMatched = true;
          }
        }
      }

      // 3. 不一致の場合、blank.html を表示（リダイレクト）
      if (!isDateMatched) {
        // 階層構造に合わせてパスは適宜調整してください。ここでは親階層と仮定します。
        location.href = "../blank.html";
      }
    });
    // ▲▲▲ 追加機能ここまで ▲▲▲

  </script>
</head>
<body>
  <div class="nav-buttons">
    <button onclick="goToRelativeDay(-1)">Previous</button>
    <button onclick="goToRelativeDay(1)">Next</button>
  </div>
<div class="box1">

    <!-- 当日News入力　ここから -->

  
<h3 class='bar3'><i class="fas fa-calendar-check"></i>2025/11/30</h3>

<ul class="nb-list"><li class="news-icon news-fct"><a href="https://full-count.jp/2025/12/01/post1871554/" target="_blank" rel="nofollow">【Full-count】西野真弘、11年目に感じた可能性「まだいける」　亡き父に感謝…明かした“不思議な力”</a></li>
<!-- (以下省略、元のリストがそのまま続きます) -->
<li class="news-icon news-nsp"><a href="https://www.nikkansports.com/premium/baseball/news/202511280000005.html" target="_blank" rel="nofollow">【日刊スポーツ】【DeNA伊藤光】チームに愛着…なのに移籍｢決断が良かったと思える日まで頑張る｣</a></li>
</ul>



    <!-- 当日News入力　ここまで -->
  
</div>
</body>
</html>
