<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>News Auto Check</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .content { margin-top: 1em; }
  </style>
</head>
<body>

  <div class="content">
    <p>【開始】</p>

    <!-- ▼ 日付は h3 から自動取得対象 -->
    <h3 class="bar3"><i class="fas fa-calendar-check"></i>2026/01/15</h3>

    <p>ここに記事本文を入力</p>

    <p>【ここまで】</p>
  </div>

  <script>
    // 今日の日付を "YYYY/MM/DD" 形式で返す
    function getTodayString() {
      const d = new Date();
      return `${d.getFullYear()}/${String(d.getMonth()+1).padStart(2,"0")}/${String(d.getDate()).padStart(2,"0")}`;
    }

    // ファイル名の月日を取得 (例: 12-06.html → "12/06")
    const fileName = location.pathname.split("/").pop();
    const [mm, dd] = fileName.replace(".html", "").split("-");
    const fileMD = `${mm}/${dd}`;

    const h3 = document.querySelector("h3.bar3");
    const today = getTodayString();
    let reason = ""; // デバッグ用
    let redirect = false;

    if (!h3) {
      reason = "❌ h3が存在しない";
      redirect = true;
    } else {
      const text = h3.textContent;
      const match = text.match(/(\d{4})\/(\d{2})\/(\d{2})/);
      if (!match) {
        reason = "❌ h3に日付形式がない";
        redirect = true;
      } else {
        const yyyy = match[1], mm2 = match[2], dd2 = match[3];
        const dateFromH3 = `${yyyy}/${mm2}/${dd2}`;
        const mdFromH3 = `${mm2}/${dd2}`;

        if (dateFromH3 !== today) {
          reason = `❌ h3の日付(${dateFromH3})が今日(${today})と一致しない`;
          redirect = true;
        } else if (mdFromH3 !== fileMD) {
          reason = `❌ h3の月日(${mdFromH3})がファイル名(${fileMD})と一致しない`;
          redirect = true;
        } else {
          reason = "✅ 一致 — 表示OK";
        }
      }
    }

    console.log("判定結果:", reason);

    if (redirect) {
      console.warn("➡ blank.html にリダイレクトします");
      setTimeout(() => { window.location.replace("blank.html"); }, 100);
    }

    // 0時更新チェック
    setInterval(() => {
      const now = new Date();
      if (now.getHours() === 0 && now.getMinutes() === 0 && now.getSeconds() === 0) {
        location.reload();
      }
    }, 1000);
  </script>
</body>
</html>
